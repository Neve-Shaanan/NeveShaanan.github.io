import{a as V,b as L}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-HUN3PJSG.js";import{a,d as D}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-24U533ZX.js";import{d as I,o as C}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-MWVFIODD.js";import{d as w,h as T}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-GUAW3NSU.js";import{b as _,c as F}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-UGELT6OI.js";import{a as x}from"https://st-p.rmcdn.net/af2666fc/dist/c/c-UGUCNLQ2.js";var E,M,R=x(()=>{"use strict";T();D();L();F();C();E={setVideoPosition:function(e){if(!e.aspect_poster||!e.$media||!e.$media.length)return;let t=e.$container.css("width"),o=e.$container.css("height");if(/px/.test(t+o))t=parseInt(t),o=parseInt(o);else{if(!e.mag)return;let l=e.mag.getContainerSizeCached();t=l.width,o=l.height}let r=e.aspect_poster,i=e.aspect_real||r,c=e.controls_remove?5:0,h=t+c*2,s=o+c*2,u=h,n=s;if(r){let l,m;h/s>i?(l=h,m=l/i):(m=s,l=m*i),r<i?(u=l,n=u/r):(n=m,u=n*r)}if(e.provider.toLowerCase()=="vimeo"&&e.controls_remove){var d=(n-s)/2,P=(u-h)/2,f=50,U=46,v=f-d,b=U-P;if(v>0||b>0){let l=(n+v*2)/n,m=(u+b*2)/u,p=Math.max(l,m);u*=p,n*=p}}if(e.provider.toLowerCase()=="youtube"&&e.controls_remove){var d=(n-s)/2,f=103,g=f-d;g>0&&(n+=g*2,u=n*r)}let y=-c-(u-h)/2,$=-c-(n-s)/2;e.$media.css({left:y,top:$,width:u,height:n})},getHighResVideoThumbnail:function(e){if(!e.provider||!e.thumbnail_url)return Promise.resolve(e.thumbnail_url||"");function t(o,r){return o.replace(/(\/)(\w*default)(\.\w+$)/i,"$1"+r+"$3")}switch(e.provider.toLowerCase()){case"vimeo":return Promise.resolve(e.thumbnail_url);case"youtube":return Promise.resolve(typeof e.video_url=="string"&&e.video_url.includes("shorts")?e.thumbnail_url:t(e.thumbnail_url,"maxresdefault"));default:return Promise.resolve(e.thumbnail_url)}},getEmbedData:async function(e,t,o,r){fetch(/oembed/i.test(e)?e:this.getEmbedUrl(e)).then(i=>i.json()).then(i=>{i.url=i.url&&w(i.url),i.thumbnail_url=i.thumbnail_url&&w(i.thumbnail_url),typeof t=="function"&&t(i)}).catch(i=>{o(i)}).finally(()=>{typeof r=="function"&&r()})},getEmbedUrl:function(e){if(this.isVimeo(e))return"https://vimeo.com/api/oembed.json?url="+encodeURIComponent(e)+"&width=1280";{let t=E.getYoutubeIdFromUrl(e);if(t)return"https://www.youtube.com/oembed?format=json&url="+encodeURIComponent("https://www.youtube.com/watch?v="+t)}return""},getYoutubeIdFromUrl:function(e){let t=/^.*(youtu.be\/|v\/|u\/\w\/|shorts\/|watch\?v=)([^#\&\?]*).*/,o=e.match(t);if(o&&o[2].length===11)return o[2];let r=/.*(youtu.*\&v=)([^#\&\?]*).*/;return o=e.match(r),o&&o[2].length===11?o[2]:null},getVimeoIdFromUrl:function(e){let t=e.match(/(video\/)(\w+)(_\d+x\d+|_\d+)(\.\w+$)/i);return t&&t[2]?t[2]:null},getVideoProvider:function(e){return this.isVimeo(e)?"Vimeo":this.isYoutube(e)?"YouTube":""},isVimeo:function(e){return/vimeo\.com\/.+/.test(e)},isYoutube:function(e){return e&&!!this.getYoutubeIdFromUrl(e)},brokenVimeoThumbnailRegexp:/\/\d+_[\dx]+(\.\w+)?$/,validateVideoFile:function(e){if(!this.allowedVideoFormats.includes(e.type))throw new Error("Please upload .mp4 or .mov files");let{video_upload_limit:t}=V.getPermissions();if(e.size>_.VIDEO_WIDGET_UPLOAD_SIZE_LIMIT)throw new Error(`Please upload files smaller than ${a(_.VIDEO_WIDGET_UPLOAD_SIZE_LIMIT)}`);if(e.size>t)throw new Error(I)},allowedVideoFormats:["video/mp4","video/quicktime"]},M=E});export{M as a,R as b};
